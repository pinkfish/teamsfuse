Add in League/Tournament support and a bunch of other minor fixes